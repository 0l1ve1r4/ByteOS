
// Helper function to count the number of tokens
size_t count_tokens(const char* str, char delim) {
    size_t count = 0;
    uint32_t in_token = 0;
    while (*str) {
        if (*str == delim) {
            in_token = 0;
        } else if (!in_token) {                         // Start of a new token
            in_token = 1;
            count++;
        }
        str++;
    }
    return count;
}

char** split_str(const char* str, char delim) {
    static char tokens[UINT8_MAX][UINT8_MAX]; // Static array for tokens
    static char* result[UINT8_MAX + 1];              // Static array for pointers to tokens
    size_t token_index = 0;

    while (*str && token_index < UINT8_MAX) {
        while (*str == delim) { // Skip delimiters
            str++;
        }

        const char* token_start = str; // Find the end of the token
        size_t token_length = 0;

        while (*str && *str != delim && token_length < UINT8_MAX - 1) {
            str++;
            token_length++;
        }

        if (token_length > 0) { // Copy the token to the static array
            for (size_t i = 0; i < token_length; i++) {
                tokens[token_index][i] = token_start[i];
            }
            tokens[token_index][token_length] = '\0'; // Null-terminate the token
            result[token_index] = tokens[token_index]; // Store the pointer to the token
            token_index++;
        }
    }

    result[token_index] = NULL; // Null-terminate the array of pointers

    return result;
}